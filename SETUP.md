# Survey Form - Setup & Deployment Guide

## Current Status
- âœ… **Frontend**: Deployed on GitHub Pages at https://workwithprnv-stack.github.io/survey/index.html
- âŒ **Backend**: NOT YET DEPLOYED (needed for data collection)

---

## How It Works

```
User fills survey form
    â†“
Frontend generates unique sessionId
    â†“
User submits â†’ POST to Backend /submit
    â†“
Backend saves to all_responses.json
    â†“
responses.html fetches from /api/responses
    â†“
Display all collected surveys
```

---

## Step 1: Push Code to GitHub (if not already done)

```bash
cd c:\Users\prana\Documents\2026\ddd\survey

git init
git add .
git commit -m "Data Driven Design Survey - Ready for deployment"
git remote add origin https://github.com/workwithprnv-stack/DESG318_surveyDesign.git
git branch -M main
git push -u origin main
```

---

## Step 2: Deploy Backend to Railway (FREE!)

### Create Railway Account
1. Go to https://railway.app
2. Sign up with GitHub (easiest)

### Deploy This Repository
1. In Railway dashboard, click **+ New Project**
2. Select **Deploy from GitHub**
3. Connect your GitHub account
4. Select repository: `DESG318_surveyDesign`
5. Railway auto-detects Node.js
6. **Wait 2-3 minutes for deployment**
7. After success, you'll get a URL like:
   ```
   https://desg318-surveydesign-production.up.railway.app
   ```

---

## Step 3: Connect Frontend to Backend

After you have the Railway URL, edit `index.html` and add this BEFORE the closing `</head>` tag:

```html
<script>
  // Set your Railway backend URL here
  window.SURVEY_SERVER_BASE = 'https://desg318-surveydesign-production.up.railway.app';
</script>
```

Replace `https://desg318-surveydesign-production.up.railway.app` with your actual Railway URL.

Then commit and push:
```bash
git add index.html
git commit -m "Set backend URL to Railway"
git push origin main
```

The GitHub Actions workflow will auto-deploy to Pages within 1-2 minutes.

---

## Step 4: Test the Survey

1. Visit: https://workwithprnv-stack.github.io/survey/index.html
2. Fill out the form completely
3. Click "Submit"
4. Go to `responses.html` (link on landing page or type in URL)
5. See your response displayed with others!

---

## File Structure

```
survey/
â”œâ”€â”€ index.html                    # Landing page + form
â”œâ”€â”€ responses.html                # View all collected responses
â”œâ”€â”€ script.js                     # Form logic + sessionId generation
â”œâ”€â”€ style.css                     # Styling
â”œâ”€â”€ server.js                     # Backend (runs on Railway)
â”œâ”€â”€ package.json                  # Dependencies
â”œâ”€â”€ all_responses.json            # Master response file (generated by server)
â”œâ”€â”€ sessions/                     # Individual response backups
â”œâ”€â”€ Procfile                      # Heroku/Railway config
â”œâ”€â”€ .gitignore                    # Exclude all_responses.json from git
â””â”€â”€ .github/workflows/
    â””â”€â”€ deploy_pages.yml          # Auto-deploy frontend to GitHub Pages
```

---

## How Sessions Work

- **Session ID** = Unique identifier for each survey submission
- Example: `ceb85c7b-23f1-468d-9a62-06681fa3fd15`
- **Each page visit** = New sessionId generated
- **Each submission** = Stored separately in `all_responses.json`

```json
{
  "responses": [
    {
      "sessionId": "session-1",
      "timestamp": "2026-02-07T10:30:00Z",
      "responses": { "q1": "Student", "q2": "3-4 times a week", ... }
    },
    {
      "sessionId": "session-2",
      "timestamp": "2026-02-07T10:35:00Z",
      "responses": { "q1": "Professor", "q2": "1-2 times a week", ... }
    }
  ]
}
```

---

## Troubleshooting

### "Cannot POST to /submit"
- Backend is not running/deployed
- Check if Railway deployment is complete
- Verify `window.SURVEY_SERVER_BASE` is set correctly

### "No responses showing in responses.html"
- Check browser console (F12 â†’ Console) for errors
- Verify backend URL in `window.SURVEY_SERVER_BASE`
- Ensure at least one survey has been submitted

### "CORS Error"
- This is expected if backend URL is not set
- The server.js has CORS enabled for all origins
- Make sure backend is deployed on Railway

---

## Local Testing (Optional)

To test locally before deploying:

```bash
cd survey
node server.js
# Server runs on http://localhost:3000
# Fill survey, responses saved to all_responses.json locally
```

---

## Next Steps

1. âœ… Code is ready in GitHub
2. â³ Deploy backend to Railway (Steps 2-3 above)
3. âœ… Frontend auto-deploys to GitHub Pages
4. ğŸ‰ Start collecting survey responses!

---

**Questions?** Check server logs on Railway dashboard for errors.
